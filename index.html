<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cooperativa Habitacional dos Empregados da Empresa Brasileira de Correios e Telégrafos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f9;
    }

    header {
      background-color: #343a40;
      color: #fff;
      padding: 15px;
      text-align: center;
    }

    .container {
      padding: 20px;
    }

    nav {
      display: flex;
      justify-content: center;
      background-color: #007bff;
    }

    nav a {
      padding: 14px 20px;
      text-decoration: none;
      color: #fff;
      text-align: center;
      flex: 1;
      border-right: 1px solid #fff;
    }

    nav a:last-child {
      border-right: none;
    }

    nav a:hover {
      background-color: #0056b3;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .form-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      font-weight: bold;
    }

    input[type="text"], input[type="number"], input[type="file"], select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button {
      background-color: #28a745;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #218838;
    }

    .form-section h2 {
      margin-top: 0;
    }

    .tab-content h3 {
      margin-top: 20px;
    }

    .subtask-button {
      background-color: #17a2b8;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 15px;
    }

    .subtask-button:hover {
      background-color: #138496;
    }

    .form-section input[type="radio"] {
      margin-right: 10px;
    }

    #partido-section {
      display: none;
    }
  </style>
</head>
<body>

  <!-- Cabeçalho com o nome da Cooperativa -->
  <header>
    <h1>Cooperativa Habitacional dos Empregados da Empresa Brasileira de Correios e Telégrafos</h1>
  </header>

  <!-- Menu de navegação (abas horizontais) -->
  <nav>
    <a href="#cadastro" onclick="showTab('cadastro')">Cadastro</a>
    <a href="#faturamento" onclick="showTab('faturamento')">Faturamento</a>
    <a href="#emitir" onclick="showTab('emitir')">Emitir</a>
    <a href="#controler" onclick="showTab('controler')">Controler</a>
    <a href="#relatorios" onclick="showTab('relatorios')">Relatórios</a>
  </nav>

  <!-- Conteúdo das abas -->
  <div class="container">

    <!-- Aba Cadastro -->
    <div id="cadastro" class="tab-content">
      <h2>Cadastro de Cooperativado</h2>
      
      <!-- Botões para Criar e Alterar -->
      <button class="subtask-button" onclick="showCreateForm()">Criar Cadastro</button>
      <button class="subtask-button" onclick="showAlterForm()">Alterar Cadastro</button>

      <!-- Formulário Criar Cadastro -->
      <div id="createForm" class="form-section" style="display: none;">
        <h3>Cadastro de Cooperativado - Criar</h3>

        <div class="form-group">
          <label for="nomeCompleto">Nome completo:</label>
          <input type="text" id="nomeCompleto">
        </div>

        <div class="form-group">
          <label for="numeroMatricula">Número de matrícula:</label>
          <input type="text" id="numeroMatricula">
        </div>

        <div class="form-group">
          <label for="dataCadastro">Data de cadastro:</label>
          <input type="date" id="dataCadastro">
        </div>

        <div class="form-group">
          <label for="nis">NIS (Número de Identificação Social):</label>
          <input type="text" id="nis">
        </div>

        <div class="form-group">
          <label for="possuiDependentes">Possui dependentes?</label>
          <select id="possuiDependentes" onchange="mostrarDependentes()">
            <option value="nao">Não</option>
            <option value="sim">Sim</option>
          </select>
        </div>

        <div id="dependentesInfo" class="dependents-container"></div>

        <div class="form-group">
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf">
        </div>

        <div class="form-group">
          <label for="endereco">Endereço:</label>
          <input type="text" id="endereco">
        </div>

        <div class="form-group">
          <label for="valor">Valor a ser pago (R$):</label>
          <input type="number" id="valor">
        </div>

        <div class="form-group">
          <label for="parcelas">Número de parcelas:</label>
          <input type="number" id="parcelas">
        </div>

        <div class="form-group">
          <label for="foto">Foto do cooperativado:</label>
          <input type="file" id="foto" accept="image/*">
        </div>

        <div class="form-group">
          <label for="titulo">Título Eleitoral:</label>
          <input type="text" id="titulo">
        </div>

        <div class="form-group">
          <label for="zona">Zona Eleitoral:</label>
          <input type="text" id="zona">
        </div>

        <div class="form-group">
          <label>Possui restrições cadastrais financeiras (SPC, Serasa, cartório ou outros)?</label>
          <input type="radio" id="restricaoSim" name="restricao" value="sim"> Sim
          <input type="radio" id="restricaoNao" name="restricao" value="nao" checked> Não
        </div>

        <div class="form-group">
          <label>É filiado a algum partido político?</label>
          <input type="radio" id="filiadoSim" name="filiado" value="sim"> Sim
          <input type="radio" id="filiadoNao" name="filiado" value="nao" checked> Não
        </div>

        <div id="partido-section" class="form-group">
          <label for="partido">Nome do Partido:</label>
          <input type="text" id="partido">
        </div>

        <div class="form-group">
          <button onclick="salvarCadastro()">Salvar Cadastro</button>
        </div>
      </div>

      <!-- Formulário Alterar Cadastro -->
      <div id="alterForm" class="form-section" style="display: none;">
        <h3>Alterar Cadastro de Cooperativado</h3>
        <p>Formulário para alteração de cadastro.</p>
        <!-- Aqui você pode implementar o formulário de alteração de cadastro se necessário -->
      </div>
    </div>

    <!-- Aba Faturamento -->
    <div id="faturamento" class="tab-content">
      <h2>Faturamento</h2>
      <p>Informações de faturamento da cooperativa.</p>
    </div>

    <!-- Aba Emitir -->
    <div id="emitir" class="tab-content">
      <h2>Emitir</h2>
      <p>Função para emitir documentos ou relatórios.</p>
    </div>

    <!-- Aba Controler -->
    <div id="controler" class="tab-content">
      <h2>Controler</h2>
      <p>Funções de controle interno e monitoramento.</p>
    </div>

    <!-- Aba Relatórios -->
    <div id="relatorios" class="tab-content">
      <h2>Relatórios</h2>
      <p>Visualizar relatórios financeiros e operacionais.</p>
      <form id="filtroRelatorio" style="margin-top: 30px; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px #0001;">
        <h3>Filtros para Relatórios</h3>
        <div class="form-group">
          <label for="tipoRelatorio">Tipo de Relatório:</label>
          <select id="tipoRelatorio">
            <option value="normal">Personalizado (usar filtros abaixo)</option>
            <option value="todos">Todos os Cooperativados</option>
            <option value="alfabetica">Ordem Alfabética</option>
            <option value="inadimplentes">Inadimplentes</option>
          </select>
        </div>
        <div class="form-group">
          <label>Período:</label>
          <input type="date" id="dataInicio"> a <input type="date" id="dataFim">
        </div>
        <div class="form-group">
          <label for="filtroNome">Nome completo:</label>
          <input type="text" id="filtroNome">
        </div>
        <div class="form-group">
          <label for="filtroMatricula">Matrícula:</label>
          <input type="text" id="filtroMatricula">
        </div>
        <div class="form-group">
          <label for="filtroRegistro">Número de registro na cooperativa:</label>
          <input type="text" id="filtroRegistro">
        </div>
        <div class="form-group">
          <label for="filtroCidade">Cidade:</label>
          <input type="text" id="filtroCidade">
        </div>
        <div class="form-group">
          <label for="filtroResidencial">Residencial:</label>
          <input type="text" id="filtroResidencial">
        </div>
        <div class="form-group">
          <label for="filtroCPF">CPF:</label>
          <input type="text" id="filtroCPF">
        </div>
        <div class="form-group">
          <button type="button" onclick="filtrarRelatorio()">Filtrar</button>
          <button type="button" onclick="gerarPDF()">Gerar PDF</button>
          <button type="button" onclick="window.print()">Imprimir</button>
        </div>
      </form>
      <div id="resultadoRelatorio" style="margin-top: 20px;"></div>
    </div>
  </div>

  <script>
    // Função para exibir a aba selecionada
    function showTab(tabId) {
      const tabs = document.querySelectorAll('.tab-content');
      tabs.forEach(tab => {
        tab.classList.remove('active');
      });
      document.getElementById(tabId).classList.add('active');
    }

    // Mostrar ou ocultar o campo de dependentes
    function mostrarDependentes() {
      const select = document.getElementById("possuiDependentes");
      const container = document.getElementById("dependentesInfo");
      container.innerHTML = "";

      if (select.value === "sim") {
        const labelQtd = document.createElement("label");
        labelQtd.textContent = "Quantidade de dependentes:";
        const inputQtd = document.createElement("input");
        inputQtd.type = "number";
        inputQtd.min = "1";
        inputQtd.onchange = () => gerarCamposDependentes(inputQtd.value);

        container.appendChild(labelQtd);
        container.appendChild(inputQtd);
      }
    }

    // Gerar campos para os dependentes
    function gerarCamposDependentes(qtd) {
      const container = document.getElementById("dependentesInfo");

      while (container.children.length > 2) {
        container.removeChild(container.lastChild);
      }

      for (let i = 1; i <= qtd; i++) {
        const input = document.createElement("input");
        input.className = "dependent-input";
        input.placeholder = `Nome completo do dependente ${i}`;
        container.appendChild(input);
      }
    }

    // Função para salvar o cadastro
    function salvarCadastro() {
      const nome = document.getElementById("nomeCompleto").value;
      const numeroMatricula = document.getElementById("numeroMatricula").value;
      const dataCadastro = document.getElementById("dataCadastro").value;
      const cpf = document.getElementById("cpf").value;
      const endereco = document.getElementById("endereco").value;
      const valor = parseFloat(document.getElementById("valor").value);
      const parcelas = parseInt(document.getElementById("parcelas").value);
      
      alert(`Cadastro de Cooperativado: ${nome} - Matrícula: ${numeroMatricula} - Data: ${dataCadastro} - CPF: ${cpf}`);
    }

    // Função para mostrar o formulário de criação
    function showCreateForm() {
      document.getElementById("createForm").style.display = "block";
      document.getElementById("alterForm").style.display = "none";
    }

    // Função para mostrar o formulário de alteração
    function showAlterForm() {
      document.getElementById("createForm").style.display = "none";
      document.getElementById("alterForm").style.display = "block";
    }

    // Função para filtrar e exibir os resultados do relatório
    function filtrarRelatorio() {
      const dados = JSON.parse(localStorage.getItem('cooperados')) || [];
      const tipo = document.getElementById('tipoRelatorio').value;
      const nome = document.getElementById('filtroNome').value.toLowerCase();
      const matricula = document.getElementById('filtroMatricula').value.toLowerCase();
      const registro = document.getElementById('filtroRegistro').value.toLowerCase();
      const cidade = document.getElementById('filtroCidade').value.toLowerCase();
      const residencial = document.getElementById('filtroResidencial').value.toLowerCase();
      const cpf = document.getElementById('filtroCPF').value.toLowerCase();
      const dataInicio = document.getElementById('dataInicio').value;
      const dataFim = document.getElementById('dataFim').value;

      function estaNoPeriodo(dataStr) {
        if (!dataStr) return true;
        const data = new Date(dataStr);
        if (dataInicio && data < new Date(dataInicio)) return false;
        if (dataFim && data > new Date(dataFim)) return false;
        return true;
      }

      let filtrados = dados;
      if (tipo === 'normal') {
        filtrados = dados.filter(c =>
          (!nome || (c.nomeCompleto||'').toLowerCase().includes(nome)) &&
          (!matricula || (c.numeroMatricula||'').toLowerCase().includes(matricula)) &&
          (!registro || (c.numeroRegistro||'').toLowerCase().includes(registro)) &&
          (!cidade || (c.cidade||'').toLowerCase().includes(cidade)) &&
          (!residencial || (c.residencial||'').toLowerCase().includes(residencial)) &&
          (!cpf || (c.cpf||'').toLowerCase().includes(cpf)) &&
          estaNoPeriodo(c.dataCadastro)
        );
      } else if (tipo === 'todos') {
        filtrados = dados.filter(c => estaNoPeriodo(c.dataCadastro));
      } else if (tipo === 'alfabetica') {
        filtrados = [...dados].filter(c => estaNoPeriodo(c.dataCadastro)).sort((a, b) => (a.nomeCompleto||'').localeCompare(b.nomeCompleto||''));
      } else if (tipo === 'inadimplentes') {
        filtrados = dados.filter(c => Number(c.valorDevido) > 0 && estaNoPeriodo(c.dataInadimplencia));
      }

      let html = '';
      if (tipo === 'inadimplentes') {
        let total = 0;
        html = '<table border="1" cellpadding="8" style="width:100%;border-collapse:collapse;margin-top:10px;"><tr><th>Nome</th><th>Matrícula</th><th>Valor Devido (R$)</th></tr>';
        filtrados.forEach(c => {
          const devido = Number(c.valorDevido)||0;
          total += devido;
          html += `<tr><td>${c.nomeCompleto||''}</td><td>${c.numeroMatricula||''}</td><td style='text-align:right;'>${devido.toFixed(2)}</td></tr>`;
        });
        html += `<tr style='font-weight:bold;background:#f2f2f2;'><td colspan='2'>Total devido</td><td style='text-align:right;'>R$ ${total.toFixed(2)}</td></tr>`;
        html += '</table>';
      } else {
        html = '<table border="1" cellpadding="8" style="width:100%;border-collapse:collapse;margin-top:10px;"><tr><th>Nome</th><th>Matrícula</th><th>Registro</th><th>Cidade</th><th>Residencial</th><th>CPF</th></tr>';
        filtrados.forEach(c => {
          html += `<tr><td>${c.nomeCompleto||''}</td><td>${c.numeroMatricula||''}</td><td>${c.numeroRegistro||''}</td><td>${c.cidade||''}</td><td>${c.residencial||''}</td><td>${c.cpf||''}</td></tr>`;
        });
        html += '</table>';
      }
      document.getElementById('resultadoRelatorio').innerHTML = html;
    }

    // Função para gerar PDF do relatório
    function gerarPDF() {
      window.print(); // Simples: imprime a tela (pode ser salvo como PDF)
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Removido código de exibição condicional do campo de período
    });
  </script>

</body>
</html>
